# azure-databricks-malware-prediction
End-to-end Machine Learning Pipeline demo using Delta Lake, MLflow and AzureML in Azure Databricks

# The Problem
The problem I set out to solve is this public [Kaggle competition](https://www.kaggle.com/c/microsoft-malware-prediction) hosted my Microsoft earlier this year. Essentially, Microsoft has provided datasets containing Windows telemetry data for a variety of machines; in order words - a dump of various windows features (Os Build, Patch version etc.) for machines like our laptops. The idea is to use the test.csv and train.csv dataset to develop a Machine Learning model that would predict a Windows machine's probability of getting infected with various families of malware.

## Architecture
![TBD](https://raw.githubusercontent.com/mdrakiburrahman/azure-databricks-malware-prediction/master/Architecture.png).<BR>

# 01-kaggle-dataset-download: Connecting to Kaggle via API and copying competition files to Azure Blob Storage

The Kaggle API allows us to connect to various competitions and datasets hosted on the platform: [API documentation](https://github.com/Kaggle/kaggle-api).<BR>
  
**Pre-requisite**: You should have downloaded the _kaggle.json_ containing the API *username* and *key* and localized the notebook below.<br><br>
In this notebook, we will -<br>
  1. Mount a container called `bronze` in Azure Blob Storage
  2. Import the competition data set in .zip format from Kaggle to the mounted container
  3. Unzip the downloaded data set and remove the zip file <BR><BR> 

# 02-extract-transform-load: EXTRACT, TRANSFORM, LOAD from BRONZE to SILVER Zone

Here is the Data Lake Architecture we are emulating:

![TBD](https://databricks.com/wp-content/uploads/2019/08/Delta-Lake-Multi-Hop-Architecture-Bronze.png).<BR>
  
**Pre-requisite**: You should have run `01-kaggle-dataset-download` to download the Kaggle dataset to BRONZE Zone. <br><br>
In this notebook, we will -<br>
  1. **EXTRACT** the downloaded Kaggle `train.csv` dataset from BRONZE Zone into a dataframe
  2. Perform various **TRANSFORMATIONS** on the dataframe to enhance/clean the data
  3. **LOAD** the data into SILVER Zone in Delta Lake format
  4. Repeat the above three steps for `test.csv`
  5. Take the Curated `test.csv` data and enhance it further for ML scoring later on. <BR><BR>
